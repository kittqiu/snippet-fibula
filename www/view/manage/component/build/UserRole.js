"use strict";var UserRole=React.createClass({displayName:"UserRole",loadUserRole:function(e){e=e||this.state.user,getJSON("/api/sys/user/"+e+"/roles",function(e,t){if(e)fatal(e);else{var a;for(this.setState({user_roles:t}),a=0;a<this.state.allroles.length;a++){var s=this.state.allroles[a];this.refs[s.id].checked=!1}for(a=0;a<t.length;a++){var s=t[a];this.refs[s.id].checked=!0}}}.bind(this))},loadRoles:function(){getJSON("/api/sys/role/list",function(e,t){e?fatal(e):this.setState({allroles:t})}.bind(this))},loadData:function(){getJSON("/api/team/member/list",function(e,t){if(e)fatal(e);else{var a=t[0].id;this.loadRoles(),this.loadUserRole(a),this.setState({users:t,user:a})}}.bind(this))},componentWillMount:function(){this.loadData()},handleUserSelected:function(e){var t=e.target.value;this.setState({user:t}),this.loadUserRole(t)},handleSubmit:function(e){e.preventDefault();var t,a=[],s=this.state.allroles,l=$("#select_user_role").find("form"),r=this.refs.user.value;for(t=0;t<s.length;t++){var i=s[t];this.refs[i.id].checked&&a.push(i.id)}console.log(a),l.postJSON("/api/sys/user/"+r+"/roles",a,function(e,t){e||UIkit.modal.alert("保存成功！")}.bind(this))},getInitialState:function(){return{users:[],allroles:[],user:"",user_roles:[]}},render:function(){return React.createElement("div",{id:"select_user_role"},React.createElement("form",{onSubmit:this.handleSubmit,className:"uk-form uk-form-stacked"},React.createElement("fieldset",null,React.createElement("div",{className:"uk-alert uk-alert-danger uk-hidden"}),React.createElement("div",{className:"uk-form-row uk-width-1-1"},React.createElement("label",{className:"uk-form-label"},"选择一个用户："),React.createElement("div",{className:"uk-form-controls"},React.createElement("select",{name:"user",ref:"user",className:"uk-width-1-1",value:this.state.user,onChange:this.handleUserSelected},this.state.users.map(function(e,t){return React.createElement("option",{key:t,value:e.id},e.name)})))),React.createElement("div",{className:"uk-form-row uk-width-1-1"},React.createElement("label",{className:"uk-form-label"},"选择启用的角色："),React.createElement("div",{className:"uk-form-controls"},this.state.allroles.map(function(e,t){return React.createElement("div",{key:e.id,className:"uk-form-controls"},React.createElement("input",{id:e.id,ref:e.id,type:"checkbox",value:e.id}),React.createElement("label",{htmlFor:e.id},e.name))}))),React.createElement("div",{className:"uk-text-center"},React.createElement("button",{type:"submit",className:"uk-button uk-button-primary"},"保存")))))}});