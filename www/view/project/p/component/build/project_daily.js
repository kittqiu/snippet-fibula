"use strict";var styles={smallBottomMargin:{marginBottom:"2px"},toolbar:{marginTop:"20px"},tableBorder:{borderCollapse:"collapse"}},ProjectTaskDaily=React.createClass({displayName:"ProjectTaskDaily",handleViewTask:function(e){e.preventDefault();var t=this.props.task;ReactDOM.render(React.createElement(TaskDialog,{task:t,onTaskChanged:this.onTaskChanged,role:"executor"}),document.getElementById("modal_task_"+t.id))},onTaskChanged:function(){},onUpdate:function(){this.setState({updateCnt:this.state.updateCnt+1})},getInitialState:function(){return{updateCnt:0}},render:function(){var e=this.props.task,t=e.daily,a=t.org_plan||"未填写",s=(t.plan||"未填写",t.report||"未填写"),l={padding:"0"},n="未填写"===a?"dv-pre-clear uk-text-muted":"dv-pre-clear",c="未填写"===s?"dv-pre-clear uk-text-muted":"dv-pre-clear",i="未填写"===s?"uk-text-muted":"";return React.createElement("tr",null,React.createElement("td",{className:"dv-border"},React.createElement("a",{onClick:this.handleViewTask,className:"uk-button-link dv-link"},e.name),React.createElement("div",{id:"modal_task_daily_"+e.id,className:"uk-modal"}),React.createElement("div",{id:"modal_task_"+e.id,className:"uk-modal"})),React.createElement("td",null,e.executor_name),React.createElement("td",null,e.manager_name),React.createElement("td",{className:"dv-border"},React.createElement("pre",{className:n,style:l},a)),React.createElement("td",{className:"dv-border"},React.createElement("pre",{className:c,style:l},s)),React.createElement("td",{className:i},t.duration?t.duration+"小时":"0"))}}),ProjectDaily=React.createClass({displayName:"ProjectDaily",loadData:function(e){getJSON("/api/project/p/"+this.props.pid,{},function(e,t){e?fatal(e):this.setState({project:t})}.bind(this)),getJSON("/api/project/p/"+this.props.pid+"/daily",{date:e},function(e,t){e?fatal(e):this.setState({tasks:t})}.bind(this))},previous:function(){var e=new Date(this.state.dayTime);e.setDate(e.getDate()-1);var t=e.getTime();this.setState({dayTime:t}),this.loadData(t)},next:function(){var e=new Date(this.state.dayTime);e.setDate(e.getDate()+1);var t=e.getTime();this.setState({dayTime:t}),this.loadData(t)},onTimeChanged:function(e){var t=toDateTime(e.target.value);this.setState({dayTime:t}),this.loadData(t)},getInitialState:function(){return{dayTime:Date.now()-864e5,tasks:[],project:{}}},componentDidMount:function(){var e=UIkit.datepicker(this.refs.time,{weekstart:0,format:"YYYY-MM-DD"});e.on("change",this.onTimeChanged),this.loadData(this.state.dayTime)},render:function(){var e={width:"80px"};return React.createElement("div",{className:"uk-width-1-1"},React.createElement("h2",{className:"uk-text-center"},React.createElement("b",null,"项目进展日志：",this.state.project.name)),React.createElement("div",{style:styles.toolbar},React.createElement("ul",{className:"uk-pagination",style:styles.smallBottomMargin},React.createElement("li",{className:"uk-pagination-previous"},React.createElement("a",{onClick:this.previous},React.createElement("i",{className:"uk-icon-angle-double-left"}),"前一天")),React.createElement("li",{className:""},React.createElement("input",{type:"text",name:"time",ref:"time",style:e,value:formatDate(this.state.dayTime),onChange:this.onTimeChanged})),React.createElement("li",{className:"uk-pagination-next"},React.createElement("a",{onClick:this.next},"后一天",React.createElement("i",{className:"uk-icon-angle-double-right"}))))),React.createElement("hr",{className:"dv-hr"}),React.createElement("div",{className:"uk-accordion"},React.createElement("table",{className:"uk-width-1-1 uk-table",style:styles.tableBorder},React.createElement("thead",null,React.createElement("tr",null,React.createElement("th",{className:"uk-width-2-10"},"任务"),React.createElement("th",{className:"uk-width-1-10"},"执行人"),React.createElement("th",{className:"uk-width-1-10"},"审核人"),React.createElement("th",{className:"uk-width-2-10"},"当日计划"),React.createElement("th",{className:"uk-width-3-10"},"当日工作"),React.createElement("th",{className:"uk-width-1-10"},"工作用时"))),React.createElement("tbody",null,this.state.tasks.map(function(e,t){return React.createElement(ProjectTaskDaily,{key:t,task:e,dayTime:this.state.dayTime})}.bind(this)))),React.createElement("div",{className:this.state.tasks.length>0?"uk-hidden":""},"无执行任务")))}});